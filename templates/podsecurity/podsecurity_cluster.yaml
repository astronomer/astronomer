{{- if semverCompare "> 1.24-0" .Capabilities.KubeVersion.Version }}
apiVersion: {{ template "apiVersion.AdmissionConfiguration" . }}
kind: AdmissionConfiguration
plugins:
- name: PodSecurity
  configuration:
    apiVersion: pod-security.admission.config.k8s.io/v1
    kind: PodSecurityConfiguration
    defaults:
      enforce: "baseline"
      audit: "restricted"
      warn: "restricted"
    exemptions:
      usernames: []
      runtimeClassNames: []
      namespaces: [kube-system]
{{- end -}}
